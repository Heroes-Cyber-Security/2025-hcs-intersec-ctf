<?php

if (isset($_GET['file']) && $_GET['file'] !== '') {
  $file = preg_replace('/flag\.txt/i', '', preg_replace('/\.\.\//', '', $_GET['file']));
  if (file_exists($file)) {
    highlight_file($file);
  } else {
    http_response_code(404);
    echo "File not found.";
  }
} else {
  highlight_file(__FILE__);
}
