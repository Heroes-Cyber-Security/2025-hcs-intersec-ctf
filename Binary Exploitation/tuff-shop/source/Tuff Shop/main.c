#include <stdio.h>
#include <stdlib.h>
int aura = 1337;

void flag(){
  FILE *file = fopen("flag.txt", "r");
  if (file == NULL) {
    printf("Error opening flag.txt\n");
    return;
  }
  char flag[100];
  fgets(flag, sizeof(flag), file);
  printf("Send this to the customer: %s\n", flag);
  fclose(file);
}

void menu(int aura){
  printf("\nTuff Menu Console\n"
         "Balance of customer: %d\n"
         "Choose what the customer is buying:\n"
         "1. Six Seven ($67)\n"
         "2. Did Unc Snap ($41)\n"
         "3. Flag ($100K)\n"
         "0. nothing\n"
         "> ", aura);
}

void buy(int choice, int quantity){
  int prices[] = {67, 41, 100000};
  int total = prices[choice - 1] * quantity;
  printf("Total cost for %d items: $%d\n", quantity, total);

  if (total > aura) {
    printf("Not enough balance\n");
    return;
  }

  aura -= total;
  printf("Purchase successful! Remaining balance: $%d\n", aura);
  if (choice == 3) {
    flag();
  }
}

int main() {
  setbuf(stdin, NULL);
  setbuf(stdout, NULL);
  setbuf(stderr, NULL);

  int choice, quantity;
  for (;;){
    menu(aura);
    scanf("%d", &choice);
    if (choice < 0 || choice > 3) {
      printf("Invalid choice\n");
      continue;
    }

    if (choice == 0) {
      printf("Exiting...\n");
      return 0;
    }

    printf("Enter quantity: ");
    scanf("%d", &quantity);
    if (quantity < 1) {
      printf("Invalid quantity\n");
      continue;
    }

    buy(choice, quantity);
  }
}