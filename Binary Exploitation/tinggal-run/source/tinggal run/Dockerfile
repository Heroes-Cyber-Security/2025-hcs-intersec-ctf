FROM ubuntu:22.04

RUN apt-get update && apt-get install -y socat build-essential

RUN useradd -m ctf

WORKDIR /app
RUN chown root:root /app && chmod 755 /app
COPY chall /app/chall

COPY flag.txt /app/flag.txt

RUN chmod 111 /app/chall
RUN chmod 444 /app/flag.txt

USER ctf
EXPOSE 1337
CMD ["socat", "TCP-LISTEN:1337,reuseaddr,fork", "EXEC:/app/chall"]
